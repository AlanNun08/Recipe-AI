# Sign-Up & Login Architecture Diagram

## System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend (React.js)                              â”‚
â”‚                   http://localhost:3000                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ LandingPage Component   â”‚      â”‚ WelcomeOnboarding       â”‚           â”‚
â”‚  â”‚                         â”‚      â”‚ Component               â”‚           â”‚
â”‚  â”‚ - Login form            â”‚      â”‚                         â”‚           â”‚
â”‚  â”‚ - Remember me checkbox  â”‚      â”‚ - Sign-up form          â”‚           â”‚
â”‚  â”‚ - Hero section          â”‚      â”‚ - Email verification    â”‚           â”‚
â”‚  â”‚ - Pricing               â”‚      â”‚ - Preferences step      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚             â”‚                                â”‚                          â”‚
â”‚             â”‚ POST /api/auth/login          â”‚ POST /api/auth/register  â”‚
â”‚             â”‚                                â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                â”‚
              â”‚                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Backend (FastAPI)                                    â”‚
â”‚                   http://localhost:8080                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ FastAPI Application                                      â”‚           â”‚
â”‚  â”‚                                                          â”‚           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚           â”‚
â”‚  â”‚ â”‚ /auth/register     â”‚     â”‚ /auth/login        â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ Endpoint           â”‚     â”‚ Endpoint           â”‚      â”‚           â”‚
â”‚  â”‚ â”‚                    â”‚     â”‚                    â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ 1. Validate input  â”‚     â”‚ 1. Normalize email â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ 2. Check MongoDB   â”‚     â”‚ 2. Search MongoDB  â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ 3. Hash password   â”‚     â”‚ 3. Verify password â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ 4. Create user     â”‚     â”‚ 4. Check verified  â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ 5. Send email      â”‚     â”‚ 5. Update timestampâ”‚      â”‚           â”‚
â”‚  â”‚ â”‚ 6. Return success  â”‚     â”‚ 6. Return user     â”‚      â”‚           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚           â”‚
â”‚  â”‚                                                          â”‚           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚           â”‚
â”‚  â”‚ â”‚ Authentication Functions                       â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ - hash_password()      â†’ bcrypt hashing       â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ - verify_password()    â†’ bcrypt comparison    â”‚      â”‚           â”‚
â”‚  â”‚ â”‚ - generate_verification_code() â†’ 6-digit code â”‚      â”‚           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚           â”‚
â”‚  â”‚                                                          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                             â”‚                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ MongoDB Queries
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MongoDB Database                                      â”‚
â”‚                   mongodb://localhost:27017                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Users Collection             â”‚   â”‚ Verification Codes           â”‚   â”‚
â”‚  â”‚ (recipe_ai.users)            â”‚   â”‚ (recipe_ai.verification)     â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚                              â”‚   â”‚
â”‚  â”‚ Documents:                   â”‚   â”‚ Documents:                   â”‚   â”‚
â”‚  â”‚ â”œâ”€ _id (ObjectId)           â”‚   â”‚ â”œâ”€ _id (ObjectId)           â”‚   â”‚
â”‚  â”‚ â”œâ”€ id (UUID) ğŸ”‘             â”‚   â”‚ â”œâ”€ email ğŸ”‘                 â”‚   â”‚
â”‚  â”‚ â”œâ”€ email (unique) ğŸ”‘        â”‚   â”‚ â”œâ”€ code (6-digit)           â”‚   â”‚
â”‚  â”‚ â”œâ”€ password_hash (bcrypt)   â”‚   â”‚ â”œâ”€ created_at               â”‚   â”‚
â”‚  â”‚ â”œâ”€ first_name               â”‚   â”‚ â”œâ”€ expires_at (TTL index)   â”‚   â”‚
â”‚  â”‚ â”œâ”€ last_name                â”‚   â”‚ â””â”€ used (boolean)           â”‚   â”‚
â”‚  â”‚ â”œâ”€ is_verified              â”‚   â”‚                              â”‚   â”‚
â”‚  â”‚ â”œâ”€ created_at               â”‚   â”‚ Indexes:                     â”‚   â”‚
â”‚  â”‚ â”œâ”€ last_login               â”‚   â”‚ â”œâ”€ email (normal)            â”‚   â”‚
â”‚  â”‚ â”œâ”€ subscription_status      â”‚   â”‚ â””â”€ expires_at (TTL)         â”‚   â”‚
â”‚  â”‚ â”œâ”€ trial_end_date           â”‚   â”‚                              â”‚   â”‚
â”‚  â”‚ â””â”€ ... (other fields)       â”‚   â”‚ TTL: Auto-delete after      â”‚   â”‚
â”‚  â”‚                              â”‚   â”‚      15 minutes              â”‚   â”‚
â”‚  â”‚ Indexes:                     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚ â”œâ”€ email (unique)           â”‚                                       â”‚
â”‚  â”‚ â”œâ”€ id (normal)              â”‚                                       â”‚
â”‚  â”‚ â””â”€ stripe_customer_id       â”‚                                       â”‚
â”‚  â”‚    (sparse)                 â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: User Sign-Up

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚ Fills registration form
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend Validation              â”‚
â”‚ â€¢ Email format check             â”‚
â”‚ â€¢ Password length (8+ chars)     â”‚
â”‚ â€¢ Terms agreement check          â”‚
â”‚ â€¢ Name validation                â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚ âœ… Valid
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/auth/register          â”‚
â”‚ Payload:                         â”‚
â”‚ {                                â”‚
â”‚   email: "user@example.com",    â”‚
â”‚   password: "SecurePass123",    â”‚
â”‚   name: "John Doe",             â”‚
â”‚   phone: ""                      â”‚
â”‚ }                                â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend Processing               â”‚
â”‚ 1. Validate email format        â”‚
â”‚ 2. Check email length           â”‚
â”‚ 3. Normalize to lowercase       â”‚
â”‚ 4. Query MongoDB:               â”‚
â”‚    db.users.findOne({email})    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€ âŒ Email exists?
     â”‚   â””â”€â†’ 400: "Already exists"
     â”‚
     â”œâ”€ âœ… Email unique
     â”‚   â–¼
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ Hash password with      â”‚
     â”‚  â”‚ bcrypt (salted)         â”‚
     â”‚  â”‚ Result: $2b$12$...      â”‚
     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚
     â”‚       â–¼
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ Create user document    â”‚
     â”‚  â”‚ in MongoDB              â”‚
     â”‚  â”‚ â€¢ id (UUID)            â”‚
     â”‚  â”‚ â€¢ email (lowercase)     â”‚
     â”‚  â”‚ â€¢ password_hash        â”‚
     â”‚  â”‚ â€¢ first_name           â”‚
     â”‚  â”‚ â€¢ last_name            â”‚
     â”‚  â”‚ â€¢ is_verified: false   â”‚
     â”‚  â”‚ â€¢ subscription_status  â”‚
     â”‚  â”‚ â€¢ trial_end_date       â”‚
     â”‚  â”‚ â€¢ created_at           â”‚
     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚
     â”‚       â–¼
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ Generate verification   â”‚
     â”‚  â”‚ code (6 digits)         â”‚
     â”‚  â”‚ Save to verification    â”‚
     â”‚  â”‚ collection (TTL: 15min) â”‚
     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚
     â”‚       â–¼
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ Send verification email â”‚
     â”‚  â”‚ via Mailjet             â”‚
     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚
     â”‚       â–¼
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ Return 201 + user data  â”‚
     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend Processes Response      â”‚
â”‚ â€¢ Store user session data        â”‚
â”‚ â€¢ Show success message           â”‚
â”‚ â€¢ Redirect to preferences        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Sign-Up Complete              â”‚
â”‚ User can now verify email        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: User Login

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User   â”‚ Enters credentials
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend Form Input              â”‚
â”‚ â€¢ Email: user@example.com        â”‚
â”‚ â€¢ Password: SecurePass123        â”‚
â”‚ â€¢ Remember Me: â˜‘                 â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend Processing              â”‚
â”‚ â€¢ Normalize email to lowercase  â”‚
â”‚ â€¢ Trim whitespace               â”‚
â”‚ â€¢ Validate format               â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/auth/login             â”‚
â”‚ Payload:                         â”‚
â”‚ {                                â”‚
â”‚   email: "user@example.com",    â”‚
â”‚   password: "SecurePass123"     â”‚
â”‚ }                                â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend Processing               â”‚
â”‚ 1. Normalize email              â”‚
â”‚ 2. Query MongoDB:               â”‚
â”‚    db.users.findOne({email})    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€ âŒ User not found?
     â”‚   â””â”€â†’ 401: "Invalid credentials"
     â”‚
     â”œâ”€ âœ… User found
     â”‚   â–¼
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ Verify password_hash     â”‚
     â”‚  â”‚ exists in document       â”‚
     â”‚  â”‚ (data validation)        â”‚
     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚
     â”‚       â”œâ”€ âŒ Missing field?
     â”‚       â”‚   â””â”€â†’ 500: "Account corrupted"
     â”‚       â”‚
     â”‚       â”œâ”€ âœ… Field exists
     â”‚       â”‚   â–¼
     â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚       â”‚  â”‚ Verify password     â”‚
     â”‚       â”‚  â”‚ bcrypt.compare(     â”‚
     â”‚       â”‚  â”‚   input_pwd,        â”‚
     â”‚       â”‚  â”‚   stored_hash       â”‚
     â”‚       â”‚  â”‚ )                   â”‚
     â”‚       â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚       â”‚
     â”‚       â”‚       â”œâ”€ âŒ Wrong password?
     â”‚       â”‚       â”‚   â””â”€â†’ 401: "Invalid"
     â”‚       â”‚       â”‚
     â”‚       â”‚       â”œâ”€ âœ… Correct password
     â”‚       â”‚       â”‚   â–¼
     â”‚       â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚       â”‚       â”‚  â”‚ Check verified  â”‚
     â”‚       â”‚       â”‚  â”‚ status          â”‚
     â”‚       â”‚       â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚       â”‚       â”‚
     â”‚       â”‚       â”‚       â”œâ”€ âŒ Not verified?
     â”‚       â”‚       â”‚       â”‚   â””â”€â†’ 403: Verification required
     â”‚       â”‚       â”‚       â”‚       (Generate new code)
     â”‚       â”‚       â”‚       â”‚
     â”‚       â”‚       â”‚       â”œâ”€ âœ… Verified
     â”‚       â”‚       â”‚       â”‚   â–¼
     â”‚       â”‚       â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚       â”‚       â”‚       â”‚  â”‚ Update       â”‚
     â”‚       â”‚       â”‚       â”‚  â”‚ last_login   â”‚
     â”‚       â”‚       â”‚       â”‚  â”‚ timestamp    â”‚
     â”‚       â”‚       â”‚       â”‚  â”‚ in MongoDB   â”‚
     â”‚       â”‚       â”‚       â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚       â”‚       â”‚       â”‚
     â”‚       â”‚       â”‚       â”‚       â–¼
     â”‚       â”‚       â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚       â”‚       â”‚       â”‚  â”‚ Return 200   â”‚
     â”‚       â”‚       â”‚       â”‚  â”‚ + User data  â”‚
     â”‚       â”‚       â”‚       â”‚  â”‚ + Sub status â”‚
     â”‚       â”‚       â”‚       â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚       â”‚       â”‚       â”‚
     â”‚       â”‚       â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚       â”‚
     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend Processes Response      â”‚
â”‚ âœ… Login successful              â”‚
â”‚ â€¢ Save user data                 â”‚
â”‚ â€¢ Check "Remember Me"            â”‚
â”‚   - â˜‘ â†’ localStorage             â”‚
â”‚   - â˜ â†’ sessionStorage           â”‚
â”‚ â€¢ Redirect to dashboard          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… User Logged In                â”‚
â”‚ Data persisted until:            â”‚
â”‚ â€¢ Remember Me: browser closed   â”‚
â”‚ â€¢ No Remember: tab closed       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MongoDB Database                            â”‚
â”‚                   (recipe_ai database)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Users Collection        â”‚  â”‚ Verification Collection   â”‚  â”‚
â”‚  â”‚  (1 doc per user)        â”‚  â”‚ (Temporary, auto-delete)  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                          â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚ {                        â”‚  â”‚ {                         â”‚  â”‚
â”‚  â”‚   _id: ObjectId,         â”‚  â”‚   _id: ObjectId,          â”‚  â”‚
â”‚  â”‚   id: UUID,              â”‚  â”‚   email: "user@...",      â”‚  â”‚
â”‚  â”‚   email: "user@...",â—„â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”€email: "user@...",     â”‚  â”‚
â”‚  â”‚   password_hash: "...",  â”‚  â”‚   code: "123456",         â”‚  â”‚
â”‚  â”‚   first_name: "John",    â”‚  â”‚   created_at: Date,       â”‚  â”‚
â”‚  â”‚   last_name: "Doe",      â”‚  â”‚   expires_at: Date, â—„â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚   is_verified: false,    â”‚  â”‚   used: false             â”‚â”‚  â”‚
â”‚  â”‚   created_at: Date,      â”‚  â”‚ }                         â”‚â”‚  â”‚
â”‚  â”‚   verified_at: null,     â”‚  â”‚                           â”‚â”‚  â”‚
â”‚  â”‚   last_login: Date,      â”‚  â”‚ TTL Index:                â”‚â”‚  â”‚
â”‚  â”‚   subscription_status: "trial",â”‚ expires_at (15 min)    â”‚â”‚  â”‚
â”‚  â”‚   trial_start_date: Date,   â”‚                           â”‚â”‚  â”‚
â”‚  â”‚   trial_end_date: Date,â—„â”€â”  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚  â”‚   ...                    â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚ }                        â”‚  â”‚ Auto-deletes when        â”‚  â”‚
â”‚  â”‚                          â”‚  â”‚ expires_at < now()        â”‚  â”‚
â”‚  â”‚ Indexes:                 â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚ â€¢ email (unique)         â”‚  â”‚ Indexes:                  â”‚  â”‚
â”‚  â”‚ â€¢ id (normal)            â”‚  â”‚ â€¢ email (normal)          â”‚  â”‚
â”‚  â”‚ â€¢ stripe_customer_id     â”‚  â”‚ â€¢ expires_at (TTL)        â”‚  â”‚
â”‚  â”‚   (sparse)               â”‚  â”‚                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          â–²                                                       â”‚
â”‚          â”‚                                                       â”‚
â”‚          â””â”€ One user can have multiple verification codes       â”‚
â”‚             (new code generated for each login attempt)         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Password Flow: Registration â†’ Login

```
Registration:
User enters: "SecurePass123"
             â”‚
             â–¼
        bcrypt.gensalt()  â† Generate salt
        + "SecurePass123"
             â”‚
             â–¼
        bcrypt.hashpw()   â† Hash with salt
             â”‚
             â–¼
        "$2b$12$..." â—„â”€ Stored in MongoDB
        (59 characters)   (includes salt)


Login:
User enters: "SecurePass123"
             â”‚
             â–¼
        bcrypt.checkpw()  â† Compare with stored
        "SecurePass123"
        vs
        "$2b$12$..."
             â”‚
        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
        â”‚          â”‚
        â–¼          â–¼
    âŒ Wrong    âœ… Correct
    Return 401  Return user data
```

---

## Security Layers

```
Layer 1: Frontend Validation
â”œâ”€ Email format (@required)
â”œâ”€ Password length (8+ chars)
â””â”€ Terms agreement

     â”‚
     â–¼

Layer 2: HTTP Transport
â”œâ”€ Content-Type validation
â”œâ”€ JSON parsing
â””â”€ CORS headers

     â”‚
     â–¼

Layer 3: Backend Validation
â”œâ”€ Email format check
â”œâ”€ Password strength
â”œâ”€ Data type validation
â””â”€ Business logic checks

     â”‚
     â–¼

Layer 4: Database Layer
â”œâ”€ Email unique constraint
â”œâ”€ Indexed field validation
â”œâ”€ Document schema
â””â”€ Atomic operations

     â”‚
     â–¼

Layer 5: Cryptographic Layer
â”œâ”€ Bcrypt hashing
â”œâ”€ Constant-time comparison
â”œâ”€ Salt generation
â””â”€ One-way encryption

     â”‚
     â–¼

Layer 6: Data Protection
â”œâ”€ Error message masking
â”œâ”€ No user enumeration
â”œâ”€ Timing attack resistance
â””â”€ Secure logging
```

---

## API Response Status Codes

```
Registration:
â”œâ”€ 201 Created       âœ… User created successfully
â”œâ”€ 400 Bad Request   âŒ Email exists / Invalid input
â””â”€ 500 Server Error  âš ï¸ Database or processing error

Login:
â”œâ”€ 200 OK            âœ… Login successful
â”œâ”€ 401 Unauthorized  âŒ Invalid email or password
â”œâ”€ 403 Forbidden     âš ï¸ Account not verified
â”œâ”€ 500 Server Error  âš ï¸ Server error
â””â”€ 503 Unavailable   âš ï¸ Service temporarily down
```

---

## Performance Characteristics

```
Without Indexes (O(n)):
â”œâ”€ 100 users:       <1ms âœ…
â”œâ”€ 1,000 users:     10ms âš ï¸
â”œâ”€ 10,000 users:    100ms âŒ
â”œâ”€ 100,000 users:   1000ms âŒ
â””â”€ 1,000,000 users: 10,000ms âŒ


With Indexes (O(log n)):
â”œâ”€ 100 users:       <1ms âœ…
â”œâ”€ 1,000 users:     <1ms âœ…
â”œâ”€ 10,000 users:    <1ms âœ…
â”œâ”€ 100,000 users:   <5ms âœ…
â””â”€ 1,000,000 users: <10ms âœ…
```

---

## Session Management

```
Login Successful
     â”‚
     â”œâ”€ "Remember Me" Checked â˜‘
     â”‚  â”œâ”€ Store in localStorage
     â”‚  â”œâ”€ Persist across browser close
     â”‚  â”œâ”€ Expires: Never (until manual logout)
     â”‚  â””â”€ Next visit: User auto-logged in
     â”‚
     â””â”€ "Remember Me" Unchecked â˜
        â”œâ”€ Store in sessionStorage
        â”œâ”€ Clears on tab close
        â”œâ”€ Clears on browser close
        â”œâ”€ Expires: End of session
        â””â”€ Next visit: User logged out
```

---

## Error Handling Flow

```
Request received
     â”‚
     â–¼
â”Œâ”€ Input Validation â”€â”
â”‚ â€¢ Format check    â”‚
â”‚ â€¢ Type check      â”‚
â”‚ â€¢ Length check    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ âŒ Invalid
       â”œâ”€â†’ 400 Bad Request
       â”‚   (Generic error message)
       â”‚
       â”œâ”€ âœ… Valid
       â”‚  â–¼
       â”‚ â”Œâ”€ Database Check â”€â”
       â”‚ â”‚ â€¢ Query MongoDB â”‚
       â”‚ â”‚ â€¢ Check indexes â”‚
       â”‚ â”‚ â€¢ Verify data   â”‚
       â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚      â”‚ âŒ Not found / Error
       â”‚      â”œâ”€â†’ 401 / 500
       â”‚      â”‚   (Appropriate status)
       â”‚      â”‚
       â”‚      â”œâ”€ âœ… Success
       â”‚      â”‚  â–¼
       â”‚      â”‚ â”Œâ”€ Business Logic â”€â”
       â”‚      â”‚ â”‚ â€¢ Verify passwordâ”‚
       â”‚      â”‚ â”‚ â€¢ Check verified â”‚
       â”‚      â”‚ â”‚ â€¢ Update state   â”‚
       â”‚      â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚      â”‚      â”‚ âŒ Failed
       â”‚      â”‚      â”œâ”€â†’ 401 / 403
       â”‚      â”‚      â”‚
       â”‚      â”‚      â”œâ”€ âœ… Success
       â”‚      â”‚      â”‚  â–¼
       â”‚      â”‚      â”‚ â”Œâ”€ Response â”€â”
       â”‚      â”‚      â”‚ â”‚ â€¢ Status 200/201
       â”‚      â”‚      â”‚ â”‚ â€¢ User data
       â”‚      â”‚      â”‚ â”‚ â€¢ Redirect info
       â”‚      â”‚      â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚      â”‚      â”‚      â”‚
       â”‚      â”‚      â”‚      â–¼
       â”‚      â”‚      â”‚   Frontend âœ…
       â”‚      â”‚      â”‚   Logged in / Registered
       â”‚      â”‚      â”‚
       â”‚      â””â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚
                                  â–¼
                              Log all errors
                              with context
```

---

## File Structure

```
Recipe-AI/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ server.py
â”‚       â”œâ”€â”€ @app.on_event("startup")
â”‚       â”‚   â””â”€â”€ create_database_indexes()
â”‚       â”‚
â”‚       â”œâ”€â”€ @app.post("/auth/register")
â”‚       â”‚   â””â”€â”€ async def register(request: UserRegistrationRequest)
â”‚       â”‚
â”‚       â”œâ”€â”€ @app.post("/auth/login")
â”‚       â”‚   â””â”€â”€ async def login(request: UserLoginRequest)
â”‚       â”‚
â”‚       â””â”€â”€ Authentication functions:
â”‚           â”œâ”€â”€ hash_password()
â”‚           â”œâ”€â”€ verify_password()
â”‚           â””â”€â”€ generate_verification_code()
â”‚
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ src/components/
â”‚       â”œâ”€â”€ LandingPage.js
â”‚       â”‚   â”œâ”€â”€ handleLogin()
â”‚       â”‚   â””â”€â”€ loginModal
â”‚       â”‚
â”‚       â””â”€â”€ WelcomeOnboarding.js
â”‚           â”œâ”€â”€ handleRegisterAccount()
â”‚           â””â”€â”€ registrationForm
â”‚
â””â”€â”€ Documentation/
    â”œâ”€â”€ SIGNUP_LOGIN_FLOW.md         (Complete technical guide)
    â”œâ”€â”€ TESTING_SIGNUP_LOGIN.md       (Test scenarios)
    â”œâ”€â”€ SIGNUP_LOGIN_COMPLETE.md      (Summary)
    â”œâ”€â”€ QUICK_REFERENCE.md            (Quick reference)
    â””â”€â”€ ARCHITECTURE_DIAGRAM.md       (This file)
```

---

## Summary

âœ… **Complete end-to-end sign-up and login flow**
âœ… **MongoDB integration for data persistence**
âœ… **Secure bcrypt password hashing**
âœ… **Database indexes for O(log n) performance**
âœ… **Email normalization and validation**
âœ… **Verification code system**
âœ… **Session management with remember me**
âœ… **Comprehensive logging and debugging**
âœ… **Production-ready error handling**
âœ… **Complete documentation and testing guides**
